;/*FB_PKG_DELIM*/

__d("CometPhotoViewerImageSuspense",["Promise","PromiseAnnotate","promiseDone","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h=["ref"],i,j,k,l=k||d("react"),m=document.body,n=typeof jest==="undefined"&&document!==void 0&&typeof document.createElement==="function";function o(a){return new(i||(i=b("Promise")))(function(b){if(!n||m==null)return b();var c=document.createElement("img");c.onload=c.onerror=b;c.src=a})}var p=new Map(),q=2e3,r={get:function(a){var b=p.get(a);if(b!=null){p["delete"](a);p.set(a,b);return b}},set:function(a,b){p["delete"](a);p.set(a,b);if(p.size>q){a=p.keys().next();a.done||p["delete"](a.value)}}};function s(a){if(a==null)return;var b=r.get(a);if(b!=null){if(b.pending===!0)throw b.promise;return}b=o(a);c("promiseDone")((j||(j=d("PromiseAnnotate"))).setDisplayName(b,"SuspenseImage"));var e={pending:!0,promise:b};c("promiseDone")(b.then(function(){e.pending===!0&&(e.pending=!1)}));r.set(a,e);throw b}function a(a){var b=d("react-compiler-runtime").c(6),c,e;b[0]!==a?(e=a.ref,c=babelHelpers.objectWithoutPropertiesLoose(a,h),b[0]=a,b[1]=c,b[2]=e):(c=b[1],e=b[2]);s(c.src);b[3]!==c||b[4]!==e?(a=l.jsx("img",babelHelpers["extends"]({},c,{ref:e})),b[3]=c,b[4]=e,b[5]=a):a=b[5];return a}g["default"]=a}),98);
__d("CometPhotoViewerInnerWrapper.react",["CometRouteRenderType","react","react-compiler-runtime","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react"),k={backgroundContainer:{alignItems:"x6s0dn4",display:"x78zum5",justifyContent:"xl56j7k",minHeight:"x1xoerdy",$$css:!0},backgroundContainerDialog:{height:"x1dr59a3",$$css:!0},backgroundContainerDialogWithFooter:{height:"x4uq5q4",$$css:!0},backgroundContainerTabs:{height:"xtp0wl1",$$css:!0},backgroundContainerTabsWithFooter:{height:"xossbfl",$$css:!0},image:{height:"xt7dq6l",maxWidth:"x193iq5w",width:"x14atkfc",$$css:!0},maxImageHeightDialog:{maxHeight:"x1bwycvy",$$css:!0},maxImageHeightDialogWithFooter:{maxHeight:"x4ju7c5",$$css:!0},maxImageHeightTabs:{maxHeight:"x85a59c",$$css:!0},maxImageHeightTabsWithFooter:{maxHeight:"x1wlxzsl",$$css:!0},passthroughImage:{backgroundPosition:"x1lvsgvq",backgroundRepeat:"xiy17q3",backgroundSize:"x1tbiz1a",height:"x5yr21d",width:"xh8yej3",$$css:!0},placeholderContainer:{width:"xh8yej3",$$css:!0}};function l(a,b){var e=d("react-compiler-runtime").c(6);a=a===void 0?!1:a;b=b===void 0?!1:b;var f=d("CometRouteRenderType").useIsPushView(),g=!a&&f&&k.backgroundContainerDialog,i=!a&&!f&&k.backgroundContainerTabs,j=a&&f&&k.backgroundContainerDialogWithFooter;a=a&&!f&&k.backgroundContainerTabsWithFooter;f=b&&k.placeholderContainer;e[0]!==g||e[1]!==i||e[2]!==j||e[3]!==a||e[4]!==f?(b=(h||(h=c("stylex")))(k.backgroundContainer,g,i,j,a,f),e[0]=g,e[1]=i,e[2]=j,e[3]=a,e[4]=f,e[5]=b):b=e[5];return b}function m(a,b){var e=d("react-compiler-runtime").c(7),f=d("CometRouteRenderType").useIsPushView(),g=!a&&f&&k.maxImageHeightDialog,i=!a&&!f&&k.maxImageHeightTabs,j=a&&f&&k.maxImageHeightDialogWithFooter;a=a&&!f&&k.maxImageHeightTabsWithFooter;f=b&&k.passthroughImage;b=!b&&k.image;var l;e[0]!==g||e[1]!==i||e[2]!==j||e[3]!==a||e[4]!==f||e[5]!==b?(l=(h||(h=c("stylex")))(g,i,j,a,f,b),e[0]=g,e[1]=i,e[2]=j,e[3]=a,e[4]=f,e[5]=b,e[6]=l):l=e[6];return l}function n(a,b){var c=d("react-compiler-runtime").c(7),e=d("CometRouteRenderType").useIsPushView(),f=!a&&e&&k.maxImageHeightDialog,g=!a&&!e&&k.maxImageHeightTabs,h=a&&e&&k.maxImageHeightDialogWithFooter;a=a&&!e&&k.maxImageHeightTabsWithFooter;e=b&&k.passthroughImage;b=!b&&k.image;var i;c[0]!==f||c[1]!==g||c[2]!==h||c[3]!==a||c[4]!==e||c[5]!==b?(i=[f,g,h,a,e,b],c[0]=f,c[1]=g,c[2]=h,c[3]=a,c[4]=e,c[5]=b,c[6]=i):i=c[6];return i}function a(a){var b=d("react-compiler-runtime").c(10),c=a.height,e=a.imageUri,f=a.ref,g=a.showPlaceholderImage,h=a.width;a=a.withFooter;g=g===void 0?!0:g;a=a===void 0?!1:a;a=m(a,!0);var i=l(!1,!0);f=f!=null?f:null;var k;b[0]!==c||b[1]!==e||b[2]!==a||b[3]!==g||b[4]!==h?(k=e!=null&&g&&j.jsx("div",{className:"x6s0dn4 x78zum5 xl56j7k xmz0i5r x1n2onr6 x5yr21d xh8yej3",children:j.jsx("div",{className:a,style:c!=null&&h!=null?{backgroundImage:"url("+e+")",maxHeight:c,maxWidth:h}:{backgroundImage:"url("+e+")"}},e)}),b[0]=c,b[1]=e,b[2]=a,b[3]=g,b[4]=h,b[5]=k):k=b[5];b[6]!==i||b[7]!==f||b[8]!==k?(c=j.jsx("div",{className:i,ref:f,children:k}),b[6]=i,b[7]=f,b[8]=k,b[9]=c):c=b[9];return c}function b(a){var b=d("react-compiler-runtime").c(9),c=a.imageComponent,e=a.imageComponentWithXStyle,f=a.ref;a=a.withFooter;a=a===void 0?!1:a;var g=m(a,!1);a=n(a,!1);var h;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(h={className:"x6s0dn4 x78zum5 xl56j7k xmz0i5r x1n2onr6"},b[0]=h):h=b[0];var i;b[1]!==c||b[2]!==e||b[3]!==g||b[4]!==a?(i=c!=null?c(g):e!=null?e(a):null,b[1]=c,b[2]=e,b[3]=g,b[4]=a,b[5]=i):i=b[5];b[6]!==f||b[7]!==i?(c=j.jsx("div",babelHelpers["extends"]({},h,{ref:f,children:i})),b[6]=f,b[7]=i,b[8]=c):c=b[8];return c}e=b;f=a;g.useCometPhotoViewerContainerStyles=l;g.CometPhotoViewerImageWrapper=e;g.CometPhotoViewerPlaceholderWrapper=f}),98);
__d("MWChatDeleteMessageEventEmitter",["BaseEventEmitter"],(function(a,b,c,d,e,f,g){"use strict";var h="deleteMessage",i=new(c("BaseEventEmitter"))();function a(a){i.emit(h,a)}function b(a){var b=i.addListener(h,a);return function(){return b.remove()}}g.emit=a;g.subscribe=b}),98);
__d("MWChatMediaData",[],(function(a,b,c,d,e,f){"use strict";var g=function(a){return a==null||a.__typename!=="MessageVideo"||a.sdUrl==null||a.image_thumb==null||a.image_thumb.uri==null||a.image_thumb.width==null||a.image_thumb.height==null||a.original_dimensions==null||a.original_dimensions.x==null||a.original_dimensions.y==null?null:{hdUrl:a.hdUrl,imageThumb:{height:a.image_thumb.height,uri:a.image_thumb.uri,width:a.image_thumb.width},legacyAttachmentID:a.legacy_attachment_id,originalDimensions:{x:a.original_dimensions.x,y:a.original_dimensions.y},sdUrl:a.sdUrl}},h=function(a){return a==null||a.__typename!=="MessageImage"||a.image==null||a.image.uri==null||a.image.width==null||a.image.height==null||a.image_thumb==null||a.image_thumb.uri==null||a.image_thumb.width==null||a.image_thumb.height==null?null:{blurredImageUri:a.blurred_image_uri,image:{downloadableUri:a.image.downloadable_uri,height:a.image.height,uri:a.image.uri,width:a.image.width},imageThumb:{height:a.image_thumb.height,uri:a.image_thumb.uri,width:a.image_thumb.width},legacyAttachmentID:a.legacy_attachment_id}},i=function(a){return a==null||a.__typename!=="MessageAnimatedImage"||a.image==null||a.image.uri==null||a.image.width==null||a.image.height==null||a.image_thumb==null||a.image_thumb.uri==null||a.image_thumb.width==null||a.image_thumb.height==null?null:{blurredImageUri:null,image:{downloadableUri:a.image.downloadable_uri,height:a.image.height,uri:a.image.uri,width:a.image.width},imageThumb:{height:a.image_thumb.height,uri:a.image_thumb.uri,width:a.image_thumb.width},legacyAttachmentID:a.legacy_attachment_id}};a=function(a){return a.reduce(function(a,b){if(b==null||b.node==null||b.node.id==null||b.node.message_id==null||b.node.blob_attachments==null||b.cursor==null)return a;var c=b.node,d=c.blob_attachments,e=c.id,f=c.message_id,j=c.timestamp_precise,k=b.cursor;c=d.map(function(a){if(a.__typename==="MessageImage"){var b=h(a);return b==null?null:{__typename:"MessageImage",attachment:b,cursor:k,messageID:f,nodeID:e,timestamp:j}}else if(a.__typename==="MessageVideo"){b=g(a);return b==null?null:{__typename:"MessageVideo",attachment:b,cursor:k,messageID:f,nodeID:e,timestamp:j}}else if(a.__typename==="MessageAnimatedImage"){b=i(a);return b==null?null:{__typename:"MessageAnimatedImage",altText:a.animated_image_caption,attachment:b,cursor:k,messageID:f,nodeID:e,timestamp:j}}else return null}).filter(Boolean);return a.concat(c)},[]).filter(Boolean)};f.normalizeMessages=a}),66);
__d("MWChatMediaReducer",[],(function(a,b,c,d,e,f){"use strict";a={curIdx:0,hasNextPage:!1,hasPrevPage:!1,initialCursor:null,isFetchingNextPage:!1,isFetchingPrevPage:!1,mediaList:[]};b=function(a,b){switch(b.type){case"initialize":return babelHelpers["extends"]({},a,{curIdx:b.curIdx,initialCursor:b.initialCursor,mediaList:b.mediaList});case"startFetchingNextPage":return babelHelpers["extends"]({},a,{isFetchingNextPage:!0});case"startFetchingPrevPage":return babelHelpers["extends"]({},a,{isFetchingPrevPage:!0});case"prevPageReceived":return babelHelpers["extends"]({},a,{curIdx:a.curIdx+b.medias.length,hasPrevPage:b.hasPrevPage,isFetchingPrevPage:!1,mediaList:b.medias.concat(a.mediaList)});case"nextPageReceived":return babelHelpers["extends"]({},a,{hasNextPage:b.hasNextPage,isFetchingNextPage:!1,mediaList:a.mediaList.concat(b.medias)});case"messageDeleted":return babelHelpers["extends"]({},a,{curIdx:Math.min(Math.max(b.curIdx,0),a.mediaList.length-1),mediaList:b.mediaList});case"viewMediaAtIndex":return babelHelpers["extends"]({},a,{curIdx:Math.min(Math.max(b.curIdx,0),a.mediaList.length-1)});default:return a}};f.initialState=a;f.reducer=b}),66);
__d("MWChatMediaRootQuery.graphql",["MWChatMediaRootQuery_facebookRelayOperation","relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"after"},c={defaultValue:null,kind:"LocalArgument",name:"before"},d={defaultValue:null,kind:"LocalArgument",name:"first"},e={defaultValue:null,kind:"LocalArgument",name:"last"},f={defaultValue:null,kind:"LocalArgument",name:"messageID"},g={defaultValue:null,kind:"LocalArgument",name:"scale"},h={defaultValue:null,kind:"LocalArgument",name:"threadID"},i=[{kind:"Variable",name:"id",variableName:"threadID"}],j={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"folder",storageKey:null},l=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Literal",name:"ascending",value:!0},{kind:"Variable",name:"before",variableName:"before"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"last",variableName:"last"},{kind:"Variable",name:"message_id",variableName:"messageID"},{kind:"Literal",name:"message_shared_media_type",value:"PHOTO_VIDEO_AND_GIF"}],m={alias:null,args:null,kind:"ScalarField",name:"message_id",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"timestamp_precise",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"legacy_attachment_id",storageKey:null},q={alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},t=[q,r,s,{alias:null,args:null,kind:"ScalarField",name:"downloadable_uri",storageKey:null}];q={alias:"image_thumb",args:[{kind:"Literal",name:"height",value:250},{kind:"Literal",name:"width",value:250}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:[q,r,s],storageKey:"image(height:250,width:250)"};r={kind:"InlineFragment",selections:[p,{alias:null,args:null,kind:"ScalarField",name:"blurred_image_uri",storageKey:null},{alias:null,args:[{kind:"Literal",name:"height",value:2048},{kind:"Variable",name:"scale",variableName:"scale"},{kind:"Literal",name:"width",value:2048}],concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:t,storageKey:null},q],type:"MessageImage",abstractKey:null};s={kind:"InlineFragment",selections:[p,{alias:"sdUrl",args:[{kind:"Literal",name:"quality",value:"SD"}],kind:"ScalarField",name:"playable_url",storageKey:'playable_url(quality:"SD")'},{alias:"hdUrl",args:[{kind:"Literal",name:"quality",value:"HD"}],kind:"ScalarField",name:"playable_url",storageKey:'playable_url(quality:"HD")'},q,{alias:null,args:null,concreteType:"Vect2",kind:"LinkedField",name:"original_dimensions",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null}],storageKey:null}],type:"MessageVideo",abstractKey:null};p={kind:"InlineFragment",selections:[p,{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"image",plural:!1,selections:t,storageKey:null},q,{alias:null,args:null,kind:"ScalarField",name:"animated_image_caption",storageKey:null}],type:"MessageAnimatedImage",abstractKey:null};t={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null};q={alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"page_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"has_next_page",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"has_previous_page",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[a,c,d,e,f,g,h],kind:"Fragment",metadata:null,name:"MWChatMediaRootQuery",selections:[{alias:null,args:i,concreteType:"MessageThread",kind:"LinkedField",name:"message_thread",plural:!1,selections:[j,k,{alias:null,args:l,concreteType:"MessagesWithAttachmentsOfThreadConnection",kind:"LinkedField",name:"messages_with_attachments",plural:!1,selections:[{alias:null,args:null,concreteType:"MessagesWithAttachmentsOfThreadEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[m,j,n,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"blob_attachments",plural:!0,selections:[o,r,s,p],storageKey:null}],type:"UserMessage",abstractKey:null}],storageKey:null},t],storageKey:null},q],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[h,f,a,d,c,e,g],kind:"Operation",name:"MWChatMediaRootQuery",selections:[{alias:null,args:i,concreteType:"MessageThread",kind:"LinkedField",name:"message_thread",plural:!1,selections:[j,k,{alias:null,args:l,concreteType:"MessagesWithAttachmentsOfThreadConnection",kind:"LinkedField",name:"messages_with_attachments",plural:!1,selections:[{alias:null,args:null,concreteType:"MessagesWithAttachmentsOfThreadEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[o,j,{kind:"InlineFragment",selections:[m,n,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"blob_attachments",plural:!0,selections:[o,r,s,p,{kind:"InlineFragment",selections:[j],type:"Node",abstractKey:"__isNode"}],storageKey:null}],type:"UserMessage",abstractKey:null}],storageKey:null},t],storageKey:null},q],storageKey:null}],storageKey:null}]},params:{id:b("MWChatMediaRootQuery_facebookRelayOperation"),metadata:{},name:"MWChatMediaRootQuery",operationKind:"query",text:null}}}();b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("MWChatMediaUtil",["ExecutionEnvironment"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a){if(!(h||(h=c("ExecutionEnvironment"))).canUseDOM)return;a.forEach(function(a){if(typeof a==="string"){var b=new Image();b.src=a}})};g.prefetchImages=a}),98);
__d("MWChatMediaViewerImage.react",["fbt","CometHero.react","CometPageletWithDiv.react","CometPhotoViewerImageSuspense","CometPhotoViewerInnerWrapper.react","MWAnimatedImageControlsUtil","MWAnimatedImageThumbnailWithPlayButton.react","MWXPressable.react","react","react-compiler-runtime","useMWMediaViewerOpenQPLLogger","useSinglePartialViewImpression"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;b.useCallback;var k=b.useState,l={pauseGIFButon:{width:"xh8yej3",$$css:!0}},m=h._(/*BTDS*/"\u10d0\u10e6\u10ec\u10d4\u10e0\u10d8\u10da\u10dd\u10d1\u10d0 \u10d0\u10e0\u10d0\u10d0 \u10ee\u10d4\u10da\u10db\u10d8\u10e1\u10d0\u10ec\u10d5\u10d3\u10dd\u10db\u10d8.");function a(a){var b=d("react-compiler-runtime").c(25),e=a.blurredImageURI,f=a.imageURI,g=a.isAnimatedImage,i=a.origHeight,n=a.origSrc,o=a.origWidth;a=k(!1);var p=a[0],q=a[1];a=d("useMWMediaViewerOpenQPLLogger").useMWMediaViewerOpenQPLLogger();var r=a.endSuccess;a=k(!1);var s=a[0],t=a[1];a=d("MWAnimatedImageControlsUtil").useGetMessengerAutoplaySetting();var u;b[0]!==r?(u=function(){r()},b[0]=r,b[1]=u):u=b[1];u=u;var v;b[2]!==u?(v={onImpressionStart:u},b[2]=u,b[3]=v):v=b[3];u=c("useSinglePartialViewImpression")(v);v=d("CometPhotoViewerInnerWrapper.react").useCometPhotoViewerContainerStyles(!0);var w=g===!0&&a!==d("MWAnimatedImageControlsUtil").MWAutoplayAnimationsSetting.ON;b[4]!==i||b[5]!==n||b[6]!==o?(g=n!=null?j.jsx(d("CometPhotoViewerInnerWrapper.react").CometPhotoViewerPlaceholderWrapper,{height:i,imageUri:n,showPlaceholderImage:n!=null&&o!=null&&i!=null,width:o,withFooter:!0}):null,b[4]=i,b[5]=n,b[6]=o,b[7]=g):g=b[7];b[8]===Symbol["for"]("react.memo_cache_sentinel")?(a=j.jsx(c("CometHero.react"),{description:"MWChatMediaViewerImage"}),b[8]=a):a=b[8];b[9]!==e||b[10]!==f||b[11]!==s||b[12]!==p||b[13]!==i||b[14]!==o||b[15]!==w?(n=e==null||p?j.jsx(d("CometPhotoViewerInnerWrapper.react").CometPhotoViewerImageWrapper,{imageComponent:function(a){return j.jsx(j.Fragment,{children:w&&s===!1?j.jsx(d("MWAnimatedImageThumbnailWithPlayButton.react").MWAnimatedImageThumbnailWithPlayButton,{altText:m.toString(),connectBottom:!1,connectTop:!1,dbAttachment:null,entryPoint:d("MWAnimatedImageThumbnailWithPlayButton.react").AnimatedImageEntryPoint.MediaViewer,mediaRenderQpl:null,message:null,onPlay:function(){return t(!0)},outgoing:!1,previewHeight:i!=null?i:0,previewWidth:o!=null?o:0,sourceURL:f}):j.jsx(c("MWXPressable.react"),{"aria-label":h._(/*BTDS*/"GIF-\u10d8\u10e1 \u10d3\u10d0\u10de\u10d0\u10e3\u10d6\u10d4\u10d1\u10d0"),hideHoverOverlay:!0,onPress:function(){w&&t(!1)},xstyle:l.pauseGIFButon,children:j.jsx(c("CometPhotoViewerImageSuspense"),{alt:m,className:a,src:f},f)})})},withFooter:!0}):j.jsx(c("MWXPressable.react"),{display:"inline",label:h._(/*BTDS*/"Tap to see sensitive content"),onPress:function(){return q(!0)},children:j.jsx(d("CometPhotoViewerInnerWrapper.react").CometPhotoViewerImageWrapper,{imageComponent:function(a){return j.jsx(j.Fragment,{children:w?j.jsx(d("MWAnimatedImageThumbnailWithPlayButton.react").MWAnimatedImageThumbnailWithPlayButton,{altText:m.toString(),connectBottom:!1,connectTop:!1,dbAttachment:null,entryPoint:d("MWAnimatedImageThumbnailWithPlayButton.react").AnimatedImageEntryPoint.MediaViewer,mediaRenderQpl:null,message:null,onPlay:function(){return t(!0)},outgoing:!1,previewHeight:i!=null?i:0,previewWidth:o!=null?o:0,sourceURL:e}):j.jsx(c("MWXPressable.react"),{"aria-label":h._(/*BTDS*/"GIF-\u10d8\u10e1 \u10d3\u10d0\u10de\u10d0\u10e3\u10d6\u10d4\u10d1\u10d0"),onPress:function(){w&&t(!1)},children:j.jsx(c("CometPhotoViewerImageSuspense"),{alt:m,className:a,src:e},e)})})},withFooter:!0})}),b[9]=e,b[10]=f,b[11]=s,b[12]=p,b[13]=i,b[14]=o,b[15]=w,b[16]=n):n=b[16];b[17]!==f||b[18]!==v||b[19]!==g||b[20]!==n?(p=j.jsxs(d("CometPageletWithDiv.react").Placeholder,{className:v,fallback:g,name:"MessengerMediaViewerPhoto",pageletType:"media",children:[a,n]},f),b[17]=f,b[18]=v,b[19]=g,b[20]=n,b[21]=p):p=b[21];b[22]!==u||b[23]!==p?(a=j.jsx("div",{"data-testid":void 0,ref:u,children:p}),b[22]=u,b[23]=p,b[24]=a):a=b[24];return a}g["default"]=a}),226);
__d("MWChatMediaViewerStage.react",["fbt","CometKeys","CometMediaViewerFilmstrip.react","CurrentEnvironment","FDSBlurredBackgroundImage.react","MWChatMediaViewerNavigationTapTarget.react","MWXLink.react","MessengerLogoSvg.react","XMessengerDotComCometRootControllerRouteBuilder","deferredLoadComponent","gkx","react","requireDeferred","useCometRouterDispatcher","useDebouncedComet","useIsReadOnlyFeatureLimitedWithThreadType","useLayerKeyCommands","useLayoutEffect_SAFE_FOR_SSR"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useMemo,l=b.useRef,m=b.useState,n=c("deferredLoadComponent")(c("requireDeferred")("MWChatMediaViewerControls.react").__setRef("MWChatMediaViewerStage.react")),o=2e3,p=c("gkx")("22681");function a(a){var b=a.activeIndex,d=a.attachmentID,e=a.backgroundSrc,f=a.children,g=a.disableNextButton,i=a.disablePrevButton,q=a.downloadLink,r=a.hideNextButton,s=a.hidePrevButton,t=a.isForwardEnabledForThread,u=a.messageID,v=a.setActiveIndex,w=a.showMessengerLink,x=c("CurrentEnvironment").messengerdotcom,y=c("gkx")("20836"),z=c("gkx")("22805"),A=c("useIsReadOnlyFeatureLimitedWithThreadType")(null);A=!A&&t&&(!y||!c("gkx")("4888"));var B=h._(/*BTDS*/"\u10ec\u10d8\u10dc\u10d0 \u10e4\u10dd\u10e2\u10dd"),C=h._(/*BTDS*/"\u10e8\u10d4\u10db\u10d3\u10d4\u10d2\u10d8 \u10e4\u10dd\u10e2\u10dd"),D=l(!0);t=m(!1);var E=t[0],F=t[1],G=l(null),H=c("useCometRouterDispatcher")();t=function(){return I.isPending()?J():I()};var I=c("useDebouncedComet")(function(){F(!1),J()},{leading:!0,wait:o}),J=c("useDebouncedComet")(function(){F(!0),D.current=!1},{leading:!1,wait:o});c("useLayoutEffect_SAFE_FOR_SSR")(function(){J(),G.current&&D.current&&G.current.focus()});var K=function(){H!=null&&H.popPushView()},L=k(function(){var b=[];!s&&!i&&b.push({command:{key:c("CometKeys").LEFT},description:B,handler:function(){return v(a.activeIndex-1)}});!r&&!g&&b.push({command:{key:c("CometKeys").RIGHT},description:C,handler:function(){return v(a.activeIndex+1)}});return b},[g,i,r,s,C,B,a.activeIndex,v]),M=j.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:"previous",label:B,onClick:function(){return v(b-1)},shouldHide:s||E,testid:void 0,trackingNode:143});E=j.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:"next",label:C,onClick:function(){return v(b+1)},shouldHide:r||E,testid:void 0,trackingNode:142});c("useLayerKeyCommands")(L);return j.jsxs("div",{className:"x6s0dn4 xal61yo x78zum5 xdt5ytf x1iyjqo2 x17upfok x1n2onr6 x87ps6o x1uvtmcs x1dr59a3 x6ikm8r x10wlt62","data-testid":void 0,onMouseMove:t,ref:G,tabIndex:0,children:[w&&j.jsx("div",{className:"xzwoauc x10l6tqk xomnu4r x1n327nk",children:j.jsx(c("MWXLink.react"),{"aria-label":h._(/*BTDS*/"Messenger-\u10d8\u10e1 \u10db\u10d7\u10d0\u10d5\u10d0\u10e0 \u10d2\u10d5\u10d4\u10e0\u10d3\u10d6\u10d4 \u10d2\u10d0\u10d3\u10d0\u10e1\u10d5\u10da\u10d0"),href:c("XMessengerDotComCometRootControllerRouteBuilder").buildURL({}),children:j.jsx(c("MessengerLogoSvg.react"),{height:"40",width:"40"})})}),j.jsx("div",{className:"x1f90px3 x1ffmiix x10l6tqk xh8yej3 x1vjfegm"}),j.jsx("div",{className:"x1ey2m1c xtijo5x x1o0tod xuzhngd x10l6tqk x13vifvy",children:e!=null?j.jsx(c("FDSBlurredBackgroundImage.react"),{src:e}):null}),j.jsxs("div",{className:"x9f619 x78zum5 x1iyjqo2 x5yr21d xl56j7k x6ikm8r x10wlt62 x1n2onr6 xh8yej3 xw8kemb x1j1r7yx",children:[d!=null&&u!=null?j.jsx("div",babelHelpers["extends"]({},{0:{className:"x6s0dn4 x78zum5 x1s65kcs x1pak89f x10l6tqk x1vjfegm"},4:{className:"x6s0dn4 x78zum5 x10l6tqk x1vjfegm xnnlda6 xtijo5x"},2:{className:"x6s0dn4 x78zum5 x10l6tqk xng8ra xxx7yvo xhtitgo"},6:{className:"x6s0dn4 x78zum5 x10l6tqk xng8ra xxx7yvo xhtitgo"},1:{className:"x6s0dn4 x78zum5 x10l6tqk xng8ra xxx7yvo xhtitgo"},5:{className:"x6s0dn4 x78zum5 x10l6tqk xng8ra xxx7yvo xhtitgo"},3:{className:"x6s0dn4 x78zum5 x10l6tqk xng8ra xxx7yvo xhtitgo"},7:{className:"x6s0dn4 x78zum5 x10l6tqk xng8ra xxx7yvo xhtitgo"}}[!!x<<2|!!y<<1|!!z<<0],{children:j.jsx(n,{attachmentID:d,canForward:A,downloadLink:q,messageID:u})})):null,j.jsxs("div",{className:"x6s0dn4 x1ey2m1c x78zum5 xtijo5x x1o0tod x1qughib x10l6tqk x13vifvy x1ja2u2z",children:[!p&&j.jsx("div",{"aria-hidden":!0,className:"x1ey2m1c x9f619 xtijo5x x1o0tod x10l6tqk x13vifvy","data-testid":void 0,onClick:K}),M,E]}),f]}),j.jsx("div",{className:"x193iq5w x6ikm8r x10wlt62 x1vjfegm",children:j.jsx(c("CometMediaViewerFilmstrip.react"),{activeIndex:b,images:a.thumbnails.map(function(a){return babelHelpers["extends"]({},a,{mediaType:"image"})}),onSetImage:v})})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("MWChatMediaViewerVideo.react",["CometRouteRenderType","MWChatVideoPlayer.react","MWVideoPlayerControllerContext.react","react","react-compiler-runtime","useMWMediaViewerOpenQPLLogger","useRoutePassthroughProps","useSinglePartialViewImpression"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useCallback,k=b.useContext,l=b.useEffect;b.useMemo;var m=b.useRef;function n(a){var b=a.fbid,e=a.hdSrc,f=a.originalHeight,g=a.originalWidth;a=a.sdSrc;var h=d("CometRouteRenderType").useIsPushView(),n=c("useRoutePassthroughProps")(),o=(n==null?void 0:n.startTimestamp)!=null?Number(n.startTimestamp):void 0;n=(n==null?void 0:n.volumeSetting)!=null?Number(n.volumeSetting):void 0;var p=m(!1),q=k(c("MWVideoPlayerControllerContext.react")),r=q.ref.current;l(function(){r!==null&&!p.current&&(r.setMuted(!1,"product_initiated"),p.current=!0)},[r,p]);q=d("useMWMediaViewerOpenQPLLogger").useMWMediaViewerOpenQPLLogger();var s=q.endSuccess;q=j(function(){s()},[s]);q=c("useSinglePartialViewImpression")({onImpressionStart:q});return i.jsx("div",babelHelpers["extends"]({},{0:{className:"x6s0dn4 x78zum5 x1iyjqo2 xl56j7k x1xoerdy xh8yej3"},2:{className:"x6s0dn4 x78zum5 x1iyjqo2 xl56j7k x1xoerdy xh8yej3 x4uq5q4"},1:{className:"x6s0dn4 x78zum5 x1iyjqo2 xl56j7k x1xoerdy xh8yej3 x1ch8t6n"},3:{className:"x6s0dn4 x78zum5 x1iyjqo2 xl56j7k x1xoerdy xh8yej3 x1ch8t6n"}}[!!h<<1|!!!h<<0],{ref:q,children:i.jsx(c("MWChatVideoPlayer.react"),{controls:"mwchat",fbid:b,hdSrc:e,initialForceHD:!0,isMediaViewer:!0,mediaRenderQpl:null,originalHeight:f,originalWidth:g,sdSrc:a,shouldForcePauseOnClick:!1,startTimestamp:o,volumeSetting:n})}))}n.displayName=n.name+" [from "+f.id+"]";function a(a){var b=d("react-compiler-runtime").c(3),e=m(null);b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e={ref:e},b[0]=e):e=b[0];e=e;e=e;b[1]!==a?(e=i.jsx(c("MWVideoPlayerControllerContext.react").Provider,{value:e,children:i.jsx(n,babelHelpers["extends"]({},a))}),b[1]=a,b[2]=e):e=b[2];return e}g["default"]=a}),98);
__d("MWChatMediaRoot.react",["fbt","CometContentNotAvailable.react","CometErrorBoundary.react","CometErrorRoot.react","CometRelay","CometRouteParams","CometRouterPushViewStackContext","FBLogger","I64","LSMessagingThreadTypeUtil","MAWThreadCutover","MWChatDeleteMessageEventEmitter","MWChatMediaData","MWChatMediaReducer","MWChatMediaRootQuery.graphql","MWChatMediaUtil","MWChatMediaViewerImage.react","MWChatMediaViewerStage.react","MWChatMediaViewerVideo.react","MWChatMessageId","MWLSThread","Promise","ReQL","ReQLSuspense","WebPixelRatio","cr:7185","deferredLoadComponent","promiseDone","react","react-compiler-runtime","requireDeferred","useIsMountedRef","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m,n=m||(m=d("react"));e=m;var o=e.useCallback,p=e.useContext,q=e.useEffect,r=e.useReducer,s=e.useState,t=c("deferredLoadComponent")(b("cr:7185")),u=c("deferredLoadComponent")(c("requireDeferred")("MWV2MediaViewerThreadCutoverWrapper.react").__setRef("MWChatMediaRoot.react")),v=20,w=i!==void 0?i:i=b("MWChatMediaRootQuery.graphql");function x(a){var e,f,g,i,j=a.props;a=a.queries;var m=d("CometRelay").useRelayEnvironment(),t=d("CometRouteParams").useRouteParams();j.manualRouteParams!=null&&(t=j.manualRouteParams);var u=p(c("CometRouterPushViewStackContext"))||[];u=u.length===0&&j.routeProps.showMessengerLink;j=s(null);var x=j[0],y=j[1];j=r(d("MWChatMediaReducer").reducer,d("MWChatMediaReducer").initialState);var z=j[0],A=z.curIdx,B=z.hasNextPage,C=z.hasPrevPage,D=z.initialCursor,E=z.isFetchingNextPage,F=z.isFetchingPrevPage,G=z.mediaList,H=j[1],I=c("useIsMountedRef")(),J=d("CometRelay").usePreloadedQuery(w,a.messengerMediaRootQueryReference);if(x!==null)throw x;q(function(){var a,b=J==null||(a=J.message_thread)==null||(a=a.messages_with_attachments)==null||(a=a.edges[0])==null?void 0:a.cursor;if(b!=null&&D===null){var c,e=J==null||(c=J.message_thread)==null||(c=c.messages_with_attachments)==null?void 0:c.edges;if(e!=null){e=d("MWChatMediaData").normalizeMessages(e);var f=0;t.attachment_id!=null&&(f=e.findIndex(function(a){return a.attachment.legacyAttachmentID===t.attachment_id}));H({curIdx:f,initialCursor:b,mediaList:e,type:"initialize"})}}},[D,J,t.attachment_id]);var K=J==null||(e=J.message_thread)==null?void 0:e.id;z=J==null||(f=J.message_thread)==null?void 0:f.folder;q(function(){return d("MWChatDeleteMessageEventEmitter").subscribe(function(a){var b=A,c=G.filter(function(c,d){c=c.messageID===a;c&&(d<=A&&A>0&&b--);return!c});c.length!==G.length&&(K!=null&&m.commitUpdate(function(a){return(a=a.get(K))==null?void 0:a.invalidateRecord()}));H({curIdx:b,mediaList:c,type:"messageDeleted"})})},[m,K,A,G]);var L=o(function(a){H({type:"startFetchingPrevPage"});if(typeof t.thread_id!=="string")return(k||(k=b("Promise"))).resolve();var c=t;c=c.thread_id;return d("CometRelay").fetchQuery(m,w,{before:a,last:v,scale:d("WebPixelRatio").get(),threadID:c}).toPromise().then(function(a){var b,c;if(!I.current)return;a=a==null||(b=a.message_thread)==null?void 0:b.messages_with_attachments;c=d("MWChatMediaData").normalizeMessages((c=a==null?void 0:a.edges)!=null?c:[]);if(c.length>0){var e;H({hasPrevPage:(a=a==null||(e=a.page_info)==null?void 0:e.has_previous_page)!=null?a:!1,medias:c,type:"prevPageReceived"})}})["catch"](function(a){if(!I.current)return;y(a)})},[m,I,t]),M=o(function(a){H({type:"startFetchingNextPage"});if(typeof t.thread_id!=="string")return(k||(k=b("Promise"))).resolve();var c=t;c=c.thread_id;return d("CometRelay").fetchQuery(m,w,{after:a,first:v,scale:d("WebPixelRatio").get(),threadID:c}).toPromise().then(function(a){var b,c;if(!I.current)return;a=a==null||(b=a.message_thread)==null?void 0:b.messages_with_attachments;c=d("MWChatMediaData").normalizeMessages((c=a==null?void 0:a.edges)!=null?c:[]);if(c.length>0){var e;H({hasNextPage:(a=a==null||(e=a.page_info)==null?void 0:e.has_next_page)!=null?a:!1,medias:c,type:"nextPageReceived"})}})["catch"](function(a){if(!I.current)return;y(a)})},[m,I,t]);q(function(){D!=null&&(c("promiseDone")(M(D)),c("promiseDone")(L(D)))},[m,M,L,D,t.thread_id]);var N=(a=(j=G[0])==null?void 0:j.cursor)!=null?a:null,O=(j=(x=G[G.length-1])==null?void 0:x.cursor)!=null?j:null;q(function(){A<=v/2&&C&&!F&&N!=null?c("promiseDone")(L(N)):A>=G.length-v/2&&B&&!E&&O!=null&&c("promiseDone")(M(O))},[A,L,M,B,C,N,O,G.length,E,F]);a=G[A-1];x=G[A+1];var P=null,Q=null;a!=null&&a.__typename==="MessageImage"&&(P=a.attachment.image.uri);x!=null&&x.__typename==="MessageImage"&&(Q=x.attachment.image.uri);q(function(){d("MWChatMediaUtil").prefetchImages([P,Q])},[P,Q]);j=G[A];a=typeof t.thread_id==="string"?(l||(l=d("I64"))).of_string(t.thread_id):null;x=d("MWLSThread").useThread(a,function(a){return d("LSMessagingThreadTypeUtil").isDiscoverablePublicBroadcastChannel(a.threadType)});if(((a=J==null||(g=J.message_thread)==null||(g=g.messages_with_attachments)==null||(g=g.edges)==null?void 0:g.length)!=null?a:0)<1){c("FBLogger")("messenger_web_media").warn("No attachments found for media viewer");return n.jsx(c("CometContentNotAvailable.react"),{})}if(D==null)return null;if(j==null)return n.jsx(c("CometContentNotAvailable.react"),{});a=G.map(function(a){var b=a.__typename,c=a.altText,d=a.attachment.imageThumb,e=d.height,f=d.uri;d=d.width;var g=h._(/*BTDS*/"\u10d0\u10e6\u10ec\u10d4\u10e0\u10d8\u10da\u10dd\u10d1\u10d0 \u10d0\u10e0\u10d0\u10d0 \u10ee\u10d4\u10da\u10db\u10d8\u10e1\u10d0\u10ec\u10d5\u10d3\u10dd\u10db\u10d8.");return{alt:b==="MessageAnimatedImage"?c!=null?c:g:g,height:e,key:(b=a.attachment.legacyAttachmentID)!=null?b:f,uri:f,width:d}}).filter(Boolean);return n.jsx(c("MWChatMediaViewerStage.react"),{activeIndex:A,attachmentID:j.attachment.legacyAttachmentID,backgroundSrc:j.__typename!=="MessageAnimatedImage"?j.attachment.imageThumb.uri:void 0,disableNextButton:E&&G[A+1]==null,disablePrevButton:F&&G[A-1]==null,downloadLink:j.__typename==="MessageVideo"?(i=j.attachment.hdUrl)!=null?i:j.attachment.sdUrl:j.attachment.image.downloadableUri,hideNextButton:!B&&G[A+1]==null,hidePrevButton:!C&&G[A-1]==null,isForwardEnabledForThread:z!=="COMMUNITY"&&z!=="E2EE_CUTOVER"&&!x,messageID:typeof t.thread_id==="string"&&j.timestamp!=null?d("MWChatMessageId").makeSent(t.thread_id,j.messageID,j.timestamp):null,setActiveIndex:function(a){return H({curIdx:a,type:"viewMediaAtIndex"})},showMessengerLink:u,thumbnails:a,children:j.__typename==="MessageVideo"?n.jsx(c("MWChatMediaViewerVideo.react"),{fbid:j.nodeID,hdSrc:j.attachment.hdUrl!=null?j.attachment.hdUrl:void 0,originalHeight:j.attachment.originalDimensions.x,originalWidth:j.attachment.originalDimensions.y,sdSrc:j.attachment.sdUrl}):j.__typename==="MessageImage"?n.jsx(c("MWChatMediaViewerImage.react"),{blurredImageURI:j.attachment.blurredImageUri,imageURI:j.attachment.image.uri}):j.__typename==="MessageAnimatedImage"?n.jsx(c("MWChatMediaViewerImage.react"),{blurredImageURI:null,imageURI:j.attachment.image.uri,isAnimatedImage:!0,origHeight:j.attachment.image.height,origWidth:j.attachment.image.width}):null})}x.displayName=x.name+" [from "+f.id+"]";function a(a){var b=d("react-compiler-runtime").c(4),e=d("CometRouteParams").useRouteParams();a.props.manualRouteParams!=null&&(e=a.props.manualRouteParams);var f=String(e.thread_id),g=String(e.attachment_id);e=String(e.message_id);g=z(g,e,f);if(g!=null)e=g;else{b[0]!==a?(f=n.jsx(x,babelHelpers["extends"]({},a)),b[0]=a,b[1]=f):f=b[1];e=f}b[2]!==e?(g=n.jsx(c("CometErrorBoundary.react"),{fallback:y,children:e}),b[2]=e,b[3]=g):g=b[3];return g}function y(){return n.jsx(c("CometErrorRoot.react"),{})}y.displayName=y.name+" [from "+f.id+"]";function z(a,b,c){var e=d("react-compiler-runtime").c(11),f;e[0]!==c?(f=(l||(l=d("I64"))).of_string(c),e[0]=c,e[1]=f):f=e[1];c=f;f=d("MAWThreadCutover").useGetCutoverOpenThreadKey(c);var g=d("MAWThreadCutover").useCutoverSecureThreadKeyForOpenThreadKey(f==null?c:void 0);c=d("MWLSThread").useThread(c);b=A(b,a);if(b==null||c==null)return null;if(f==null&&g==null)return null;a=f!=null?f:c.threadKey;f=g!=null?g:c.threadKey;e[2]!==b||e[3]!==c?(g=n.jsx(t,{initialAttachment:b,thread:c}),e[2]=b,e[3]=c,e[4]=g):g=e[4];var h;e[5]!==b||e[6]!==a||e[7]!==f||e[8]!==g||e[9]!==c.threadType?(h=n.jsx(u,{initialAttachment:b,openThreadKey:a,secureThreadKey:f,threadType:c.threadType,children:g}),e[5]=b,e[6]=a,e[7]=f,e[8]=g,e[9]=c.threadType,e[10]=h):h=e[10];return h}function A(a,b){var e=d("react-compiler-runtime").c(5),g=(j||(j=c("useReStore")))(),h,i;e[0]!==b||e[1]!==g.tables.attachments||e[2]!==a?(h=function(){return d("ReQL").fromTableAscending(g.tables.attachments).filter(function(c){return c.messageId===a&&c.attachmentFbid===b})},i=[g.tables.attachments,a,b],e[0]=b,e[1]=g.tables.attachments,e[2]=a,e[3]=h,e[4]=i):(h=e[3],i=e[4]);return d("ReQLSuspense").useFirst(h,i,f.id+":618")}g["default"]=a}),226);
__d("MWV2MediaViewerContentDeferred",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";a=c("requireDeferred")("MWV2MediaViewerContent.react").__setRef("MWV2MediaViewerContentDeferred");b=a;g["default"]=b}),98);